template:
  name: coding-team
  description: Multi-agent team with orchestrator, planner, coder, and reviewer

config:
  providers:
    - name: default
      kind: anthropic
      api_key: ${ANTHROPIC_API_KEY}
      model: claude-sonnet-4-20250514

  agents:
    - name: orchestrator
      description: Delegates tasks to planner, coder, and reviewer
      instructions: >-
        You are a task orchestrator. Every user request must go through a
        plan-first pipeline: (1) delegate to planner, (2) delegate coding work
        based on the plan, (3) delegate to reviewer for verification. Never
        skip the planning step. Never write code yourself.
      provider: default
      toolboxes:
        - tasks
        - notes
      skills:
        - orchestrator-workflow
      options:
        max_iterations: 15
        max_delegation_depth: 2

    - name: planner
      description: Analyzes code and creates implementation plans
      instructions: >-
        You are a code planner. Analyze the codebase, understand the
        architecture, and create detailed implementation plans. Your primary
        output is a plan note â€” you must always write one before finishing.
        If requirements are ambiguous, use ask_user to clarify before planning.
      provider: default
      toolboxes:
        - filesystem
        - search
        - git
        - ask
        - tasks
        - notes
      skills:
        - planner-workflow
      effects:
        - kind: observation_mask
      options:
        max_iterations: 10

    - name: coder
      description: Implements code changes
      instructions: >-
        You are a coder. Your first action must always be to read the plan note
        written by the planner. Implement changes based on that plan, stay
        within your assigned file scope, write clean code, and run tests to
        verify your work.
      provider: default
      toolboxes:
        - filesystem
        - exec
        - search
        - git
        - http
        - tasks
        - notes
      skills:
        - coder-workflow
      effects:
        - kind: loop_detect
        - kind: reflection
        - kind: progress
        - kind: trim_tool_results
        - kind: compact
          params:
            threshold: 0.8
      options:
        max_iterations: 20

    - name: reviewer
      description: Reviews implementation for correctness and quality
      instructions: >-
        You are a code reviewer. Read the plan note and the coder's result note,
        then review the changed files against the plan's acceptance criteria.
        Write a review note summarizing your findings and call task_complete.
      provider: default
      toolboxes:
        - filesystem
        - search
        - exec
        - notes
      skills:
        - reviewer-workflow
      effects:
        - kind: observation_mask
      options:
        max_iterations: 10

  entry_agent: orchestrator

embedded_skills:
  - name: orchestrator-workflow
  - name: planner-workflow
  - name: coder-workflow
  - name: reviewer-workflow
